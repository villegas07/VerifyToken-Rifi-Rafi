<div class="reset-container">
  <div class="reset-card">
    
    <!-- Header -->
    <div class="reset-header">
      <fa-icon [icon]="faLock" class="header-icon"></fa-icon>
      <h1>Restablecer Contraseña</h1>
      <p>Ingresa tu nueva contraseña para TurisApp Colombia</p>
    </div>

    <!-- Form State -->
    <div *ngIf="resetState === 'form'" class="reset-form">
      <form (ngSubmit)="resetPassword()" #passwordForm="ngForm">
        
        <!-- New Password Field -->
        <div class="form-group">
          <label for="newPassword">Nueva Contraseña</label>
          <div class="password-input">
            <input 
              type="{{ showPassword ? 'text' : 'password' }}"
              id="newPassword"
              name="newPassword"
              [(ngModel)]="newPassword"
              (ngModelChange)="onPasswordChange()"
              placeholder="Ingresa tu nueva contraseña"
              class="form-control"
              [class.error]="passwordErrors.length > 0"
              required
              minlength="6"
              maxlength="36">
            <button 
              type="button" 
              class="toggle-password"
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'">
              <fa-icon [icon]="showPassword ? faEyeSlash : faEye"></fa-icon>
            </button>
          </div>
          
          <!-- Password Requirements -->
          <div class="password-requirements">
            <small>La contraseña debe tener entre 6 y 36 caracteres</small>
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="form-group">
          <label for="confirmPassword">Confirmar Nueva Contraseña</label>
          <div class="password-input">
            <input 
              type="{{ showConfirmPassword ? 'text' : 'password' }}"
              id="confirmPassword"
              name="confirmPassword"
              [(ngModel)]="confirmPassword"
              (ngModelChange)="onPasswordChange()"
              placeholder="Confirma tu nueva contraseña"
              class="form-control"
              [class.error]="passwordErrors.length > 0"
              required>
            <button 
              type="button" 
              class="toggle-password"
              (click)="toggleConfirmPasswordVisibility()"
              [attr.aria-label]="showConfirmPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'">
              <fa-icon [icon]="showConfirmPassword ? faEyeSlash : faEye"></fa-icon>
            </button>
          </div>
        </div>

        <!-- Password Errors -->
        <div *ngIf="passwordErrors.length > 0" class="validation-errors">
          <div *ngFor="let error of passwordErrors" class="error-item">
            <fa-icon [icon]="faExclamationCircle"></fa-icon>
            <span>{{ error }}</span>
          </div>
        </div>

        <!-- Submit Button -->
        <button 
          type="submit" 
          class="reset-btn"
          [disabled]="passwordErrors.length > 0 || !newPassword || !confirmPassword">
          Restablecer Contraseña
        </button>

      </form>
    </div>

    <!-- Loading State -->
    <div *ngIf="resetState === 'loading'" class="reset-loading">
      <fa-icon [icon]="faSpinner" class="loading-icon fa-spin"></fa-icon>
      <h2>Restableciendo contraseña...</h2>
      <p>Por favor espera mientras procesamos tu solicitud</p>
    </div>

    <!-- Success State -->
    <div *ngIf="resetState === 'success'" class="reset-success">
      <fa-icon [icon]="faCheckCircle" class="success-icon"></fa-icon>
      <h2>¡Contraseña restablecida exitosamente!</h2>
      <p>Tu contraseña ha sido cambiada correctamente. Ya puedes iniciar sesión con tu nueva contraseña.</p>
      
      <div class="success-actions">
        <button class="primary-btn" (click)="goToLogin()">
          Ir a Iniciar Sesión
        </button>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="resetState === 'error'" class="reset-error">
      <fa-icon [icon]="faExclamationTriangle" class="error-icon"></fa-icon>
      <h2>Error al restablecer contraseña</h2>
      <p class="error-message">{{ errorMessage }}</p>
      
      <div class="error-actions">
        <button class="retry-btn" (click)="retryReset()">
          Intentar Nuevamente
        </button>
        
        <div class="help-actions">
          <p>¿Necesitas ayuda?</p>
          <button class="link-btn" (click)="requestNewToken()">
            Solicitar nuevo enlace
          </button>
        </div>
      </div>
    </div>

  </div>

</div>